#

\begin{figure}[h]
\centering
\includegraphics[width=12cm]{img.jpg}
\caption{阿斯諾特莉亞一行人正準備接受學院長所羅的跑腿，出自動畫《盛開的阿斯諾特莉亞》}
\end{figure}

「春日逆風之中，當果敢、謹慎、知禮，我等五芒星，伴隨光華榮耀，學習、精進。」\
在魔法學園都市亞修拉姆，有著被稱呼為五芒星的少女們，為了成為真正的淑女而一同學習著知識、禮儀、以及魔法。\
所羅大人管理這整個學院，平常十分繁忙，連買東西這種小事情，也得委託五芒星們去做。\
這天，依然有許多公文等著所羅處理，然而所羅每次收到新的工作時，總是隨便地把公文塞進那座公文堆裡，有時放在最上層，但有時又不知為何從最下面塞進去。\
而且所羅也不會按照公文來到的順序處理，總是根據她當下的心情，挑選與其相符，工作量為 $x$ 的工作，而且還是從上往下數，第 $k$ 次出現的工作處理，根本毫無章法可言。\
影遁貓佩爾迪拉偶而會來監督一下所羅的工作做得如何，但按照所羅的工作態度，其實她也不知道剩下多少工作，每次總是糊弄過去。\
然而這天，充滿好奇心的特莉來到學院長的辦公室，正好撞見佩爾迪拉來監督，身為學生的表率，所羅可不能丟臉，然而她也不知道自己工作處理得如何，於是請你幫忙統計工作處理狀況。

首先會告訴以今早一開始公文堆的狀況，由上到下每個工作的工作量 $a_i$。\
接著這整天會發生以下4種事件：\
1. 所羅收到工作量為 $x$ 的公文，塞到公文堆的最下面。\
2. 所羅收到工作量為 $x$ 的公文，放到公文堆的最上面。\
3. 所羅從上到下檢視公文堆，找到出現第 $k$ 次工作量為 $x$ 的公文，抽出來處理，處理完該公文即消失，不會塞回公文堆。\
4. 佩爾迪拉詢問當下從公文堆從上往下數第 $l$ 個到第 $r$ 個公文的總工作量。

\clearpage

## 輸入
第一行有兩個正整數 $n,~q$，代表一早公文堆內的工作數量以及接下來的事件數量。\
第二行有 $n$ 個正整數 $a_1,~a_2,~\dots,~a_n$，$a_i$ 表示從上往下數第 $i$ 個工作的工作量。\
接下來有 $q$ 行，表示每個事件，格式如下（不含引號）：

- "1 x" 表示事件1。
- "2 x" 表示事件2。
- "3 x k" 表示事件3。
- "4 l r" 表示事件4。

## 輸出
對於每個事件4，輸出一行，包含一個正整數，表示當下佩爾迪拉詢問的總工作量。\
最後再輸出一行，為經過所有事件結束後，公文堆由上到下，每個工作的工作量，以空格隔開。

## 輸入限制
- $1 \leq n,~q \leq 10^5$
- $-10^9 \leq a_i \leq 10^9$
- 對於事件1或事件2，$-10^9 \leq x \leq 10^9$
- 對於事件3，保證找得到公文。
- 對於事件4，$1 \leq l \leq r \leq$ 當下公文堆的工作數量。

## 子任務
\subtasks

\clearpage

## 範例輸入
\testfile{0-01.in}

## 範例輸出
\testfile{0-01.out}
